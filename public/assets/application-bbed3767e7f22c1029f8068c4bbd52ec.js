var app=angular.module("App",["ui.bootstrap","leaflet-directive","templates","ngRoute"]);app.config(["$httpProvider",function(e){e.defaults.headers.common["X-CSRF-Token"]=$("meta[name=csrf-token]").attr("content")}]),app.config(["$routeProvider","$locationProvider",function(e,t){t.html5Mode(!0),e.when("/",{templateUrl:"index.html",controller:"SiteCtrl"}).when("/new",{templateUrl:"new.html",controller:"SiteCtrl"}).when("/map",{templateUrl:"map.html",controller:"SiteCtrl"}).when("/about",{templateUrl:"about.html",controller:"SiteCtrl"})}]),angular.module("templates",[]),app.directive("alerts",function(){return{controller:["$scope","AlertService",function(e,t){e.getAlerts=function(){return t.get()},e.closeAlert=function(t){e.alerts.splice(t,1)}}],restrict:"E",template:'<alert ng-repeat="alert in getAlerts()" type="{{alert.type}}" close="closeAlert($index)"> {{alert.text}} </alert>',replace:!0,link:function(){}}}),function(e){var t=e.L;t.labelVersion="0.2.2-dev",t.Label=(t.Layer?t.Layer:t.Class).extend({includes:t.Mixin.Events,options:{className:"",clickable:!1,direction:"right",noHide:!1,offset:[12,-15],opacity:1,zoomAnimation:!0},initialize:function(e,a){t.setOptions(this,e),this._source=a,this._animated=t.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(e){this._map=e,this._pane=this.options.pane?e._panes[this.options.pane]:this._source instanceof t.Marker?e._panes.markerPane:e._panes.popupPane,this._container||this._initLayout(),this._pane.appendChild(this._container),this._initInteraction(),this._update(),this.setOpacity(this.options.opacity),e.on("moveend",this._onMoveEnd,this).on("viewreset",this._onViewReset,this),this._animated&&e.on("zoomanim",this._zoomAnimation,this),t.Browser.touch&&!this.options.noHide&&(t.DomEvent.on(this._container,"click",this.close,this),e.on("click",this.close,this))},onRemove:function(e){this._pane.removeChild(this._container),e.off({zoomanim:this._zoomAnimation,moveend:this._onMoveEnd,viewreset:this._onViewReset},this),this._removeInteraction(),this._map=null},setLatLng:function(e){return this._latlng=t.latLng(e),this._map&&this._updatePosition(),this},setContent:function(e){return this._previousContent=this._content,this._content=e,this._updateContent(),this},close:function(){var e=this._map;e&&(t.Browser.touch&&!this.options.noHide&&(t.DomEvent.off(this._container,"click",this.close),e.off("click",this.close,this)),e.removeLayer(this))},updateZIndex:function(e){this._zIndex=e,this._container&&this._zIndex&&(this._container.style.zIndex=e)},setOpacity:function(e){this.options.opacity=e,this._container&&t.DomUtil.setOpacity(this._container,e)},_initLayout:function(){this._container=t.DomUtil.create("div","leaflet-label "+this.options.className+" leaflet-zoom-animated"),this.updateZIndex(this._zIndex)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updatePosition(),this._container.style.visibility="")},_updateContent:function(){this._content&&this._map&&this._prevContent!==this._content&&"string"==typeof this._content&&(this._container.innerHTML=this._content,this._prevContent=this._content,this._labelWidth=this._container.offsetWidth)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},_setPosition:function(e){var a=this._map,n=this._container,r=a.latLngToContainerPoint(a.getCenter()),o=a.layerPointToContainerPoint(e),i=this.options.direction,l=this._labelWidth,s=t.point(this.options.offset);"right"===i||"auto"===i&&o.x<r.x?(t.DomUtil.addClass(n,"leaflet-label-right"),t.DomUtil.removeClass(n,"leaflet-label-left"),e=e.add(s)):(t.DomUtil.addClass(n,"leaflet-label-left"),t.DomUtil.removeClass(n,"leaflet-label-right"),e=e.add(t.point(-s.x-l,s.y))),t.DomUtil.setPosition(n,e)},_zoomAnimation:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPosition(t)},_onMoveEnd:function(){this._animated&&"auto"!==this.options.direction||this._updatePosition()},_onViewReset:function(e){e&&e.hard&&this._update()},_initInteraction:function(){if(this.options.clickable){var e=this._container,a=["dblclick","mousedown","mouseover","mouseout","contextmenu"];t.DomUtil.addClass(e,"leaflet-clickable"),t.DomEvent.on(e,"click",this._onMouseClick,this);for(var n=0;a.length>n;n++)t.DomEvent.on(e,a[n],this._fireMouseEvent,this)}},_removeInteraction:function(){if(this.options.clickable){var e=this._container,a=["dblclick","mousedown","mouseover","mouseout","contextmenu"];t.DomUtil.removeClass(e,"leaflet-clickable"),t.DomEvent.off(e,"click",this._onMouseClick,this);for(var n=0;a.length>n;n++)t.DomEvent.off(e,a[n],this._fireMouseEvent,this)}},_onMouseClick:function(e){this.hasEventListeners(e.type)&&t.DomEvent.stopPropagation(e),this.fire(e.type,{originalEvent:e})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e}),"contextmenu"===e.type&&this.hasEventListeners(e.type)&&t.DomEvent.preventDefault(e),"mousedown"!==e.type?t.DomEvent.stopPropagation(e):t.DomEvent.preventDefault(e)}}),t.BaseMarkerMethods={showLabel:function(){return this.label&&this._map&&(this.label.setLatLng(this._latlng),this._map.showLabel(this.label)),this},hideLabel:function(){return this.label&&this.label.close(),this},setLabelNoHide:function(e){this._labelNoHide!==e&&(this._labelNoHide=e,e?(this._removeLabelRevealHandlers(),this.showLabel()):(this._addLabelRevealHandlers(),this.hideLabel()))},bindLabel:function(e,a){var n=this.options.icon?this.options.icon.options.labelAnchor:this.options.labelAnchor,r=t.point(n)||t.point(0,0);return r=r.add(t.Label.prototype.options.offset),a&&a.offset&&(r=r.add(a.offset)),a=t.Util.extend({offset:r},a),this._labelNoHide=a.noHide,this.label||(this._labelNoHide||this._addLabelRevealHandlers(),this.on("remove",this.hideLabel,this).on("move",this._moveLabel,this).on("add",this._onMarkerAdd,this),this._hasLabelHandlers=!0),this.label=new t.Label(a,this).setContent(e),this},unbindLabel:function(){return this.label&&(this.hideLabel(),this.label=null,this._hasLabelHandlers&&(this._labelNoHide||this._removeLabelRevealHandlers(),this.off("remove",this.hideLabel,this).off("move",this._moveLabel,this).off("add",this._onMarkerAdd,this)),this._hasLabelHandlers=!1),this},updateLabelContent:function(e){this.label&&this.label.setContent(e)},getLabel:function(){return this.label},_onMarkerAdd:function(){this._labelNoHide&&this.showLabel()},_addLabelRevealHandlers:function(){this.on("mouseover",this.showLabel,this).on("mouseout",this.hideLabel,this),t.Browser.touch&&this.on("click",this.showLabel,this)},_removeLabelRevealHandlers:function(){this.off("mouseover",this.showLabel,this).off("mouseout",this.hideLabel,this),t.Browser.touch&&this.off("click",this.showLabel,this)},_moveLabel:function(e){this.label.setLatLng(e.latlng)}},t.Icon.Default.mergeOptions({labelAnchor:new t.Point(9,-20)}),t.Marker.mergeOptions({icon:new t.Icon.Default}),t.Marker.include(t.BaseMarkerMethods),t.Marker.include({_originalUpdateZIndex:t.Marker.prototype._updateZIndex,_updateZIndex:function(e){var t=this._zIndex+e;this._originalUpdateZIndex(e),this.label&&this.label.updateZIndex(t)},_originalSetOpacity:t.Marker.prototype.setOpacity,setOpacity:function(e,t){this.options.labelHasSemiTransparency=t,this._originalSetOpacity(e)},_originalUpdateOpacity:t.Marker.prototype._updateOpacity,_updateOpacity:function(){var e=0===this.options.opacity?0:1;this._originalUpdateOpacity(),this.label&&this.label.setOpacity(this.options.labelHasSemiTransparency?this.options.opacity:e)},_originalSetLatLng:t.Marker.prototype.setLatLng,setLatLng:function(e){return this.label&&!this._labelNoHide&&this.hideLabel(),this._originalSetLatLng(e)}}),t.CircleMarker.mergeOptions({labelAnchor:new t.Point(0,0)}),t.CircleMarker.include(t.BaseMarkerMethods),t.Path.include({bindLabel:function(e,a){return this.label&&this.label.options===a||(this.label=new t.Label(a,this)),this.label.setContent(e),this._showLabelAdded||(this.on("mouseover",this._showLabel,this).on("mousemove",this._moveLabel,this).on("mouseout remove",this._hideLabel,this),t.Browser.touch&&this.on("click",this._showLabel,this),this._showLabelAdded=!0),this},unbindLabel:function(){return this.label&&(this._hideLabel(),this.label=null,this._showLabelAdded=!1,this.off("mouseover",this._showLabel,this).off("mousemove",this._moveLabel,this).off("mouseout remove",this._hideLabel,this)),this},updateLabelContent:function(e){this.label&&this.label.setContent(e)},_showLabel:function(e){this.label.setLatLng(e.latlng),this._map.showLabel(this.label)},_moveLabel:function(e){this.label.setLatLng(e.latlng)},_hideLabel:function(){this.label.close()}}),t.Map.include({showLabel:function(e){return this.addLayer(e)}}),t.FeatureGroup.include({clearLayers:function(){return this.unbindLabel(),this.eachLayer(this.removeLayer,this),this},bindLabel:function(e,t){return this.invoke("bindLabel",e,t)},unbindLabel:function(){return this.invoke("unbindLabel")},updateLabelContent:function(e){this.invoke("updateLabelContent",e)}})}(window,document),!function(){"use strict";angular.module("leaflet-directive",[]).directive("leaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletEvents",function(e,t,a,n,r){var o;return{restrict:"EA",replace:!0,scope:{center:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"="},transclude:!0,template:'<div class="angular-leaflet-map"><div ng-transclude></div></div>',controller:["$scope",function(t){o=e.defer(),this.getMap=function(){return o.promise},this.getLeafletScope=function(){return t}}],link:function(e,i,l){function s(){isNaN(l.width)?i.css("width",l.width):i.css("width",l.width+"px")}function u(){isNaN(l.height)?i.css("height",l.height):i.css("height",l.height+"px")}var c=n.isDefined,d=a.setDefaults(e.defaults,l.id),f=r.genDispatchMapEvent,p=r.getAvailableMapEvents();c(l.width)&&(s(),e.$watch(function(){return i[0].getAttribute("width")},function(){s(),g.invalidateSize()})),c(l.height)&&(u(),e.$watch(function(){return i[0].getAttribute("height")},function(){u(),g.invalidateSize()}));var g=new L.Map(i[0],a.getMapCreationDefaults(l.id));if(o.resolve(g),c(l.center)||g.setView([d.center.lat,d.center.lng],d.center.zoom),!c(l.tiles)&&!c(l.layers)){var v=L.tileLayer(d.tileLayer,d.tileLayerOptions);v.addTo(g),t.setTiles(v,l.id)}if(c(g.zoomControl)&&c(d.zoomControlPosition)&&g.zoomControl.setPosition(d.zoomControlPosition),c(g.zoomControl)&&d.zoomControl===!1&&g.zoomControl.removeFrom(g),c(g.zoomsliderControl)&&c(d.zoomsliderControl)&&d.zoomsliderControl===!1&&g.zoomsliderControl.removeFrom(g),!c(l.eventBroadcast))for(var h="broadcast",m=0;m<p.length;m++){var y=p[m];g.on(y,f(e,y,h),{eventName:y})}g.whenReady(function(){t.setMap(g,l.id)}),e.$on("$destroy",function(){g.remove(),t.unresolveMap(l.id)}),e.$on("invalidateSize",function(){g.invalidateSize()})}}}]),angular.module("leaflet-directive").directive("center",["$log","$q","$location","$timeout","leafletMapDefaults","leafletHelpers","leafletBoundsHelpers","leafletEvents",function(e,t,a,n,r,o,i,l){var s,u=o.isDefined,c=o.isNumber,d=o.isSameCenterOnMap,f=o.safeApply,p=o.isValidCenter,g=i.isValidBounds,v=o.isUndefinedOrEmpty,h=function(e,t){return u(e)&&g(e)&&v(t)};return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:function(){s=t.defer(),this.getCenter=function(){return s.promise}},link:function(t,o,g,v){var m=v.getLeafletScope(),y=m.center;v.getMap().then(function(o){var v=r.getDefaults(g.id);if(-1!==g.center.search("-"))return e.error('The "center" variable can\'t use a "-" on his key name: "'+g.center+'".'),void o.setView([v.center.lat,v.center.lng],v.center.zoom);if(h(m.bounds,y))o.fitBounds(i.createLeafletBounds(m.bounds)),y=o.getCenter(),f(m,function(e){e.center={lat:o.getCenter().lat,lng:o.getCenter().lng,zoom:o.getZoom(),autoDiscover:!1}}),f(m,function(e){var t=o.getBounds();e.bounds={northEast:{lat:t._northEast.lat,lng:t._northEast.lng},southWest:{lat:t._southWest.lat,lng:t._southWest.lng}}});else{if(!u(y))return e.error('The "center" property is not defined in the main scope'),void o.setView([v.center.lat,v.center.lng],v.center.zoom);u(y.lat)&&u(y.lng)||u(y.autoDiscover)||angular.copy(v.center,y)}var L,b;if("yes"===g.urlHashCenter){var k=function(){var e,t=a.search();if(u(t.c)){var n=t.c.split(":");3===n.length&&(e={lat:parseFloat(n[0]),lng:parseFloat(n[1]),zoom:parseInt(n[2],10)})}return e};L=k(),m.$on("$locationChangeSuccess",function(e){var t=e.currentScope,a=k();u(a)&&!d(a,o)&&(t.center={lat:a.lat,lng:a.lng,zoom:a.zoom})})}m.$watch("center",function(t){return u(L)&&(angular.copy(L,t),L=void 0),p(t)||t.autoDiscover===!0?t.autoDiscover===!0?(c(t.zoom)||o.setView([v.center.lat,v.center.lng],v.center.zoom),void o.locate(c(t.zoom)&&t.zoom>v.center.zoom?{setView:!0,maxZoom:t.zoom}:u(v.maxZoom)?{setView:!0,maxZoom:v.maxZoom}:{setView:!0})):void(b&&d(t,o)||(m.settingCenterFromScope=!0,o.setView([t.lat,t.lng],t.zoom),l.notifyCenterChangedToBounds(m,o),n(function(){m.settingCenterFromScope=!1}))):void e.warn("[AngularJS - Leaflet] invalid 'center'")},!0),o.whenReady(function(){b=!0}),o.on("moveend",function(){s.resolve(),l.notifyCenterUrlHashChanged(m,o,g,a.search()),d(y,o)||t.settingCenterFromScope||f(m,function(e){m.settingCenterFromScope||(e.center={lat:o.getCenter().lat,lng:o.getCenter().lng,zoom:o.getZoom(),autoDiscover:!1}),l.notifyCenterChangedToBounds(m,o)})}),y.autoDiscover===!0&&o.on("locationerror",function(){e.warn("[AngularJS - Leaflet] The Geolocation API is unauthorized on this page."),p(y)?(o.setView([y.lat,y.lng],y.zoom),l.notifyCenterChangedToBounds(m,o)):(o.setView([v.center.lat,v.center.lng],v.center.zoom),l.notifyCenterChangedToBounds(m,o))})})}}}]),angular.module("leaflet-directive").directive("tiles",["$log","leafletData","leafletMapDefaults","leafletHelpers",function(e,t,a,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(r,o,i,l){var s=n.isDefined,u=l.getLeafletScope(),c=u.tiles;return s(c)||s(c.url)?void l.getMap().then(function(e){var n,r=a.getDefaults(i.id);u.$watch("tiles",function(a){var o=r.tileLayerOptions,l=r.tileLayer;return!s(a.url)&&s(n)?void e.removeLayer(n):s(n)?s(a.url)&&s(a.options)&&!angular.equals(a.options,o)?(e.removeLayer(n),o=r.tileLayerOptions,angular.copy(a.options,o),l=a.url,n=L.tileLayer(l,o),n.addTo(e),void t.setTiles(n,i.id)):void(s(a.url)&&n.setUrl(a.url)):(s(a.options)&&angular.copy(a.options,o),s(a.url)&&(l=a.url),n=L.tileLayer(l,o),n.addTo(e),void t.setTiles(n,i.id))},!0)}):void e.warn("[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.")}}}]),angular.module("leaflet-directive").directive("legend",["$log","$http","leafletHelpers","leafletLegendHelpers",function(e,t,a,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(r,o,i,l){var s,u,c,d,f=a.isArray,p=a.isDefined,g=a.isFunction,v=l.getLeafletScope(),h=v.legend;v.$watch("legend",function(e){p(e)&&(s=e.legendClass?e.legendClass:"legend",u=e.position||"bottomright",d=e.type||"arcgis")},!0),l.getMap().then(function(a){v.$watch("legend",function(t){return p(t)?p(t.url)||"arcgis"!==d||f(t.colors)&&f(t.labels)&&t.colors.length===t.labels.length?p(t.url)?void e.info("[AngularJS - Leaflet] loading legend service."):(p(c)&&(c.removeFrom(a),c=null),c=L.control({position:u}),"arcgis"===d&&(c.onAdd=n.getOnAddArrayLegend(t,s)),void c.addTo(a)):void e.warn("[AngularJS - Leaflet] legend.colors and legend.labels must be set."):void(p(c)&&(c.removeFrom(a),c=null))}),v.$watch("legend.url",function(r){p(r)&&t.get(r).success(function(e){p(c)?n.updateLegend(c.getContainer(),e,d,r):(c=L.control({position:u}),c.onAdd=n.getOnAddLegend(e,s,d,r),c.addTo(a)),p(h.loadedData)&&g(h.loadedData)&&h.loadedData()}).error(function(){e.warn("[AngularJS - Leaflet] legend.url not loaded.")})})})}}}]),angular.module("leaflet-directive").directive("geojson",["$log","$rootScope","leafletData","leafletHelpers",function(e,t,a,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,r,o,i){var l=n.safeApply,s=n.isDefined,u=i.getLeafletScope(),c={};i.getMap().then(function(e){u.$watchCollection("geojson",function(r){if(s(c)&&e.hasLayer(c)&&e.removeLayer(c),s(r)&&s(r.data)){var i,d=r.resetStyleOnMouseout;i=angular.isFunction(r.onEachFeature)?r.onEachFeature:function(e,a){n.LabelPlugin.isLoaded()&&s(r.label)&&a.bindLabel(e.properties.description),a.on({mouseover:function(a){l(u,function(){t.$broadcast("leafletDirectiveMap.geojsonMouseover",e,a)})},mouseout:function(e){d&&c.resetStyle(e.target),l(u,function(){t.$broadcast("leafletDirectiveMap.geojsonMouseout",e)})},click:function(a){l(u,function(){t.$broadcast("leafletDirectiveMap.geojsonClick",e,a)})}})},s(r.options)||(r.options={style:r.style,filter:r.filter,onEachFeature:i,pointToLayer:r.pointToLayer}),c=L.geoJson(r.data,r.options),a.setGeoJSON(c,o.id),c.addTo(e)}})})}}}]),angular.module("leaflet-directive").directive("layers",["$log","$q","leafletData","leafletHelpers","leafletLayerHelpers","leafletControlHelpers",function(e,t,a,n,r,o){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:["$scope",function(e){e._leafletLayers=t.defer(),this.getLayers=function(){return e._leafletLayers.promise}}],link:function(e,t,i,l){var s=n.isDefined,u={},c=l.getLeafletScope(),d=c.layers,f=r.createLayer,p=o.updateLayersControl,g=!1;l.getMap().then(function(t){e._leafletLayers.resolve(u),a.setLayers(u,i.id),u.baselayers={},u.overlays={};var n=i.id,r=!1;for(var o in d.baselayers){var l=f(d.baselayers[o]);s(l)?(u.baselayers[o]=l,d.baselayers[o].top===!0&&(t.addLayer(u.baselayers[o]),r=!0)):delete d.baselayers[o]}!r&&Object.keys(u.baselayers).length>0&&t.addLayer(u.baselayers[Object.keys(d.baselayers)[0]]);for(o in d.overlays){"cartodb"===d.overlays[o].type;var v=f(d.overlays[o]);s(v)?(u.overlays[o]=v,d.overlays[o].visible===!0&&t.addLayer(u.overlays[o])):delete d.overlays[o]}c.$watch("layers.baselayers",function(e){for(var a in u.baselayers)s(e[a])||(t.hasLayer(u.baselayers[a])&&t.removeLayer(u.baselayers[a]),delete u.baselayers[a]);for(var r in e)if(s(u.baselayers[r]))e[r].top!==!0||t.hasLayer(u.baselayers[r])?e[r].top===!1&&t.hasLayer(u.baselayers[r])&&t.removeLayer(u.baselayers[r]):t.addLayer(u.baselayers[r]);else{var o=f(e[r]);s(o)&&(u.baselayers[r]=o,e[r].top===!0&&t.addLayer(u.baselayers[r]))}var i=!1;for(var l in u.baselayers)if(t.hasLayer(u.baselayers[l])){i=!0;break}!i&&Object.keys(d.baselayers).length>0&&t.addLayer(u.baselayers[Object.keys(d.baselayers)[0]]),g=p(t,n,g,e,d.overlays,u)},!0),c.$watch("layers.overlays",function(e){for(var a in u.overlays)s(e[a])||(t.hasLayer(u.overlays[a])&&t.removeLayer(u.overlays[a]),delete u.overlays[a]);for(var r in e){if(!s(u.overlays[r])){var o=f(e[r]);s(o)&&(u.overlays[r]=o,e[r].visible===!0&&t.addLayer(u.overlays[r]))}e[r].visible&&!t.hasLayer(u.overlays[r])?t.addLayer(u.overlays[r]):e[r].visible===!1&&t.hasLayer(u.overlays[r])&&t.removeLayer(u.overlays[r]),e[r].visible&&t._loaded&&e[r].data&&"heatmap"===e[r].type&&(u.overlays[r].setData(e[r].data),u.overlays[r].update())}g=p(t,n,g,d.baselayers,e,u)},!0)})}}}]),angular.module("leaflet-directive").directive("bounds",["$log","$timeout","leafletHelpers","leafletBoundsHelpers",function(e,t,a,n){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","center"],link:function(r,o,i,l){var s=a.isDefined,u=n.createLeafletBounds,c=l[0].getLeafletScope(),d=l[0],f=function(e){return 0===e._southWest.lat&&0===e._southWest.lng&&0===e._northEast.lat&&0===e._northEast.lng};d.getMap().then(function(a){c.$on("boundsChanged",function(e){var t=e.currentScope,n=a.getBounds();if(!f(n)&&!t.settingBoundsFromScope){var r={northEast:{lat:n._northEast.lat,lng:n._northEast.lng},southWest:{lat:n._southWest.lat,lng:n._southWest.lng}};angular.equals(t.bounds,r)||(t.bounds=r)}}),c.$watch("bounds",function(n){if(!s(n))return void e.error("[AngularJS - Leaflet] Invalid bounds");var o=u(n);o&&!a.getBounds().equals(o)&&(r.settingBoundsFromScope=!0,a.fitBounds(o),t(function(){r.settingBoundsFromScope=!1}))},!0)})}}}]),angular.module("leaflet-directive").directive("markers",["$log","$rootScope","$q","leafletData","leafletHelpers","leafletMapDefaults","leafletMarkersHelpers","leafletEvents",function(e,t,a,n,r,o,i,l){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(t,o,s,u){var c=u[0],d=r,f=r.isDefined,p=r.isString,g=c.getLeafletScope(),v=i.deleteMarker,h=i.addMarkerWatcher,m=i.listenMarkerEvents,y=i.addMarkerToGroup,b=l.bindMarkerEvents,k=i.createMarker;c.getMap().then(function(t){var r,o={};r=f(u[1])?u[1].getLayers:function(){var e=a.defer();return e.resolve(),e.promise},r().then(function(a){n.setMarkers(o,s.id),g.$watch("markers",function(n){for(var r in o)f(n)&&f(n[r])||(v(o[r],t,a),delete o[r]);var l=!f(s.watchMarkers)||"true"===s.watchMarkers;for(var u in n)if(-1===u.search("-")){if(!f(o[u])){var c=n[u],A=k(c);if(!f(A)){e.error("[AngularJS - Leaflet] Received invalid data on the marker "+u+".");continue}if(o[u]=A,f(c.message)&&A.bindPopup(c.message,c.popupOptions),f(c.group)){var w=f(c.groupOption)?c.groupOption:null;y(A,c.group,w,t)}if(d.LabelPlugin.isLoaded()&&f(c.label)&&f(c.label.message)&&A.bindLabel(c.label.message,c.label.options),f(c)&&f(c.layer)){if(!p(c.layer)){e.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!f(a)){e.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!f(a.overlays)||!f(a.overlays[c.layer])){e.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"');continue}var C=a.overlays[c.layer];if(!(C instanceof L.LayerGroup||C instanceof L.FeatureGroup)){e.error('[AngularJS - Leaflet] Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"');continue}C.addLayer(A),!l&&t.hasLayer(A)&&c.focus===!0&&i.manageOpenPopup(A,c)}else f(c.group)||(t.addLayer(A),l||c.focus!==!0||i.manageOpenPopup(A,c));l&&h(A,u,g,a,t),m(A,c,g,l),b(A,u,c,g)}}else e.error('The marker can\'t use a "-" on his key name: "'+u+'".')},!0)})})}}}]),angular.module("leaflet-directive").directive("paths",["$log","$q","leafletData","leafletMapDefaults","leafletHelpers","leafletPathsHelpers","leafletEvents",function(e,t,a,n,r,o,i){return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(l,s,u,c){var d=c[0],f=r.isDefined,p=r.isString,g=d.getLeafletScope(),v=g.paths,h=o.createPath,m=i.bindPathEvents,y=o.setPathOptions;d.getMap().then(function(o){var i,l=n.getDefaults(u.id);i=f(c[1])?c[1].getLayers:function(){var e=t.defer();return e.resolve(),e.promise},f(v)&&i().then(function(t){var n={};a.setPaths(n,u.id);var i=!f(u.watchPaths)||"true"===u.watchPaths,s=function(e,a){var n=g.$watch('paths["'+a+'"]',function(a,r){if(!f(a)){if(f(r.layer))for(var i in t.overlays){var l=t.overlays[i];l.removeLayer(e)}return o.removeLayer(e),void n()}y(e,a.type,a)},!0)};g.$watchCollection("paths",function(a){for(var u in n)f(a[u])||(o.removeLayer(n[u]),delete n[u]);for(var c in a)if(0!==c.search("\\$"))if(-1===c.search("-")){if(!f(n[c])){var d=a[c],v=h(c,a[c],l);if(f(v)&&f(d.message)&&v.bindPopup(d.message),r.LabelPlugin.isLoaded()&&f(d.label)&&f(d.label.message)&&v.bindLabel(d.label.message,d.label.options),f(d)&&f(d.layer)){if(!p(d.layer)){e.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!f(t)){e.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!f(t.overlays)||!f(t.overlays[d.layer])){e.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group"');continue}var b=t.overlays[d.layer];if(!(b instanceof L.LayerGroup||b instanceof L.FeatureGroup)){e.error('[AngularJS - Leaflet] Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"');continue}n[c]=v,b.addLayer(v),i?s(v,c):y(v,d.type,d)}else f(v)&&(n[c]=v,o.addLayer(v),i?s(v,c):y(v,d.type,d));m(v,c,d,g)}}else e.error('[AngularJS - Leaflet] The path name "'+c+'" is not valid. It must not include "-" and a number.')})})})}}}]),angular.module("leaflet-directive").directive("controls",["$log","leafletHelpers",function(e,t){return{restrict:"A",scope:!1,replace:!1,require:"?^leaflet",link:function(e,a,n,r){if(r){var o=t.isDefined,i=r.getLeafletScope(),l=i.controls;r.getMap().then(function(e){if(o(L.Control.Draw)&&o(l.draw)){o(l.edit)||(l.edit={featureGroup:new L.FeatureGroup},e.addLayer(l.edit.featureGroup));var t=new L.Control.Draw(l);e.addControl(t)}if(o(l.scale)){var a=new L.control.scale;e.addControl(a)}if(o(l.custom))for(var n in l.custom)e.addControl(l.custom[n])})}}}}]),angular.module("leaflet-directive").directive("eventBroadcast",["$log","$rootScope","leafletHelpers","leafletEvents",function(e,t,a,n){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(t,r,o,i){var l=a.isObject,s=a.isDefined,u=i.getLeafletScope(),c=u.eventBroadcast,d=n.getAvailableMapEvents(),f=n.genDispatchMapEvent;i.getMap().then(function(t){var a,n,r=[],o="broadcast";if(s(c.map))if(l(c.map))if("emit"!==c.map.logic&&"broadcast"!==c.map.logic?e.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):o=c.map.logic,l(c.map.enable)&&c.map.enable.length>=0)for(a=0;a<c.map.enable.length;a++)n=c.map.enable[a],-1===r.indexOf(n)&&-1!==d.indexOf(n)&&r.push(n);else e.warn("[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.");else e.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model.");else r=d;for(a=0;a<r.length;a++)n=r[a],t.on(n,f(u,n,o),{eventName:n})})}}}]),angular.module("leaflet-directive").directive("maxbounds",["$log","leafletMapDefaults","leafletBoundsHelpers",function(e,t,a){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,n,r){var o=r.getLeafletScope(),i=a.isValidBounds;r.getMap().then(function(e){o.$watch("maxbounds",function(t){if(!i(t))return void e.setMaxBounds();var a=[[t.southWest.lat,t.southWest.lng],[t.northEast.lat,t.northEast.lng]];e.setMaxBounds(a),n.center||e.fitBounds(a)})})}}}]),angular.module("leaflet-directive").directive("decorations",["$log","leafletHelpers",function(e,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(a,n,r,o){function i(t){return c(t)&&c(t.coordinates)&&(u.isLoaded()||e.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(t.coordinates)}function l(e,t){return c(e)&&c(t)&&c(t.coordinates)&&c(t.patterns)?(e.setPaths(t.coordinates),e.setPatterns(t.patterns),e):void 0}var s=o.getLeafletScope(),u=t.PolylineDecoratorPlugin,c=t.isDefined,d={};o.getMap().then(function(e){s.$watch("decorations",function(t){for(var a in d)c(t)&&c(t[a])||(e.removeLayer(d[a]),delete d[a]);for(var n in t){var r=t[n],o=i(r);c(o)&&(d[n]=o,e.addLayer(o),l(o,r))}},!0)})}}}]),angular.module("leaflet-directive").directive("layercontrol",["$log","leafletData","leafletHelpers",function(e,t,a){return{restrict:"E",scope:{},replace:!0,transclude:!1,require:"^leaflet",controller:["$scope","$element","$sce",function(n,r,o){e.debug("[Angular Directive - Layers] layers",n,r);var i=a.safeApply,l=a.isDefined;angular.extend(n,{baselayer:"",icons:{uncheck:"fa fa-check-square-o",check:"fa fa-square-o",radio:"fa fa-dot-circle-o",unradio:"fa fa-circle-o",up:"fa fa-angle-up",down:"fa fa-angle-down",open:"fa fa-angle-double-down",close:"fa fa-angle-double-up"},changeBaseLayer:function(e,r){a.safeApply(n,function(a){a.baselayer=e,t.getMap().then(function(r){t.getLayers().then(function(t){if(!r.hasLayer(t.baselayers[e])){for(var o in a.layers.baselayers)a.layers.baselayers[o].icon=a.icons.unradio,r.hasLayer(t.baselayers[o])&&r.removeLayer(t.baselayers[o]);r.addLayer(t.baselayers[e]),a.layers.baselayers[e].icon=n.icons.radio}})})}),r.preventDefault()},moveLayer:function(e,t,a){var r=Object.keys(n.layers.baselayers).length;if(t>=1+r&&t<=n.overlaysArray.length+r){var o;for(var l in n.layers.overlays)if(n.layers.overlays[l].index===t){o=n.layers.overlays[l];break}o&&i(n,function(){o.index=e.index,e.index=t})}a.stopPropagation(),a.preventDefault()},initIndex:function(e,t){var a=Object.keys(n.layers.baselayers).length;e.index=l(e.index)?e.index:t+a+1},toggleOpacity:function(t,a){if(e.debug("Event",t),a.visible){var r=angular.element(t.currentTarget);r.toggleClass(n.icons.close+" "+n.icons.open),r=r.parents(".lf-row").find(".lf-opacity"),r.toggle("fast",function(){i(n,function(){a.opacityControl=!a.opacityControl})})}t.stopPropagation(),t.preventDefault()},unsafeHTML:function(e){return o.trustAsHtml(e)}});var s=r.get(0);L.Browser.touch?L.DomEvent.on(s,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(s),L.DomEvent.on(s,"mousewheel",L.DomEvent.stopPropagation))}],template:'<div class="angular-leaflet-control-layers" ng-show="overlaysArray.length"><div class="lf-baselayers"><div class="lf-row" ng-repeat="(key, layer) in layers.baselayers"><label class="lf-icon-bl" ng-click="changeBaseLayer(key, $event)"><input class="leaflet-control-layers-selector" type="radio" name="lf-radio" ng-show="false" ng-checked="baselayer === key" ng-value="key" /> <i class="lf-icon lf-icon-radio" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label></div></div><div class="lf-overlays"><div class="lf-container"><div class="lf-row" ng-repeat="layer in overlaysArray | orderBy:\'index\':order" ng-init="initIndex(layer, $index)"><label class="lf-icon-ol"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-model="layer.visible"/> <i class="lf-icon lf-icon-check" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div><div class="lf-icons"><i class="lf-icon lf-up" ng-class="icons.up" ng-click="moveLayer(layer, layer.index - orderNumber, $event)"></i> <i class="lf-icon lf-down" ng-class="icons.down" ng-click="moveLayer(layer, layer.index + orderNumber, $event)"></i> <i class="lf-icon lf-open" ng-class="layer.opacityControl? icons.close:icons.open" ng-click="toggleOpacity($event, layer)"></i></div></label><div class="lf-legend" ng-if="layer.legend" ng-bind-html="unsafeHTML(layer.legend)"></div><div class="lf-opacity" ng-show="layer.visible &amp;&amp; layer.opacityControl"><input type="text" class="lf-opacity-control" name="lf-opacity-control" data-key="{{layer.index}}" /></div></div></div></div></div>',link:function(n,r,o,i){var l=a.isDefined,s=i.getLeafletScope(),u=s.layers;o.order=!l(o.order)||"normal"!==o.order&&"reverse"!==o.order?"normal":o.order,n.order="normal"===o.order,n.orderNumber="normal"===o.order?-1:1,n.layers=u,i.getMap().then(function(a){s.$watch("layers.baselayers",function(e){t.getLayers().then(function(t){var r;for(r in e)e[r].icon=a.hasLayer(t.baselayers[r])?n.icons.radio:n.icons.unradio})}),s.$watch("layers.overlays",function(o){var i=[];t.getLayers().then(function(e){for(var t in o)o[t].icon=n.icons[o[t].visible?"uncheck":"check"],i.push(o[t]),l(o[t].index)&&e.overlays[t].setZIndex&&e.overlays[t].setZIndex(o[t].index)});var s=n.$watch(function(){return r.children().size()>1?(r.find(".lf-overlays").trigger("resize"),r.find(".lf-opacity").size()===Object.keys(u.overlays).length):void 0},function(o){o===!0&&(l(r.find(".lf-opacity-control").ionRangeSlider)?r.find(".lf-opacity-control").each(function(e,r){var o,i=Object.keys(u.baselayers).length;for(var s in n.overlaysArray)n.overlaysArray[s].index===e+i+1&&(o=n.overlaysArray[s]);var c=angular.element(r),d=l(o)&&l(o.layerOptions)?o.layerOptions.opacity:void 0;c.ionRangeSlider({min:0,from:l(d)?Math.ceil(100*d):100,step:1,max:100,prettify:!1,hasGrid:!1,hideMinMax:!0,onChange:function(e){t.getLayers().then(function(t){var n,r,o=e.input.data().key;for(var i in u.overlays)if(u.overlays[i].index===o){n=t.overlays[i],r=u.overlays[i];break}a.hasLayer(n)&&(r.layerOptions=l(r.layerOptions)?r.layerOptions:{},r.layerOptions.opacity=e.input.val()/100,n.setOpacity&&n.setOpacity(e.input.val()/100),n.getLayers&&n.eachLayer&&n.eachLayer(function(t){t.setOpacity&&t.setOpacity(e.input.val()/100)}))})}})}):e.warn("[AngularJS - Leaflet] Ion Slide Range Plugin is not loaded"),s())});n.overlaysArray=i},!0)})}}}]),angular.module("leaflet-directive").service("leafletData",["$log","$q","leafletHelpers",function(e,t,a){var n=a.getDefer,r=a.getUnresolvedDefer,o=a.setResolvedDefer,i={},l={},s={},u={},c={},d={},f={},p={};this.setMap=function(e,t){var a=r(i,t);a.resolve(e),o(i,t)},this.getMap=function(e){var t=n(i,e);return t.promise},this.unresolveMap=function(e){var t=a.obtainEffectiveMapId(i,e);i[t]=void 0,l[t]=void 0,s[t]=void 0,u[t]=void 0,c[t]=void 0,d[t]=void 0,f[t]=void 0,p[t]=void 0},this.getPaths=function(e){var t=n(u,e);
return t.promise},this.setPaths=function(e,t){var a=r(u,t);a.resolve(e),o(u,t)},this.getMarkers=function(e){var t=n(c,e);return t.promise},this.setMarkers=function(e,t){var a=r(c,t);a.resolve(e),o(c,t)},this.getLayers=function(e){var t=n(s,e);return t.promise},this.setLayers=function(e,t){var a=r(s,t);a.resolve(e),o(s,t)},this.getUTFGrid=function(e){var t=n(f,e);return t.promise},this.setUTFGrid=function(e,t){var a=r(f,t);a.resolve(e),o(f,t)},this.setTiles=function(e,t){var a=r(l,t);a.resolve(e),o(l,t)},this.getTiles=function(e){var t=n(l,e);return t.promise},this.setGeoJSON=function(e,t){var a=r(d,t);a.resolve(e),o(d,t)},this.getGeoJSON=function(e){var t=n(d,e);return t.promise},this.setDecorations=function(e,t){var a=r(p,t);a.resolve(e),o(p,t)},this.getDecorations=function(e){var t=n(p,e);return t.promise}}]),angular.module("leaflet-directive").factory("leafletMapDefaults",["$q","leafletHelpers",function(e,t){function a(){return{keyboard:!0,dragging:!0,worldCopyJump:!1,doubleClickZoom:!0,scrollWheelZoom:!0,tap:!0,touchZoom:!0,zoomControl:!0,zoomsliderControl:!1,zoomControlPosition:"topleft",attributionControl:!0,controls:{layers:{visible:!0,position:"topright",collapsed:!0}},crs:L.CRS.EPSG3857,tileLayer:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}}}var n=t.isDefined,r=t.isObject,o=t.obtainEffectiveMapId,i={};return{getDefaults:function(e){var t=o(i,e);return i[t]},getMapCreationDefaults:function(e){var t=o(i,e),a=i[t],r={maxZoom:a.maxZoom,keyboard:a.keyboard,dragging:a.dragging,zoomControl:a.zoomControl,doubleClickZoom:a.doubleClickZoom,scrollWheelZoom:a.scrollWheelZoom,tap:a.tap,touchZoom:a.touchZoom,attributionControl:a.attributionControl,worldCopyJump:a.worldCopyJump,crs:a.crs};if(n(a.minZoom)&&(r.minZoom=a.minZoom),n(a.zoomAnimation)&&(r.zoomAnimation=a.zoomAnimation),n(a.fadeAnimation)&&(r.fadeAnimation=a.fadeAnimation),n(a.markerZoomAnimation)&&(r.markerZoomAnimation=a.markerZoomAnimation),a.map)for(var l in a.map)r[l]=a.map[l];return r},setDefaults:function(e,t){var l=a();n(e)&&(l.doubleClickZoom=n(e.doubleClickZoom)?e.doubleClickZoom:l.doubleClickZoom,l.scrollWheelZoom=n(e.scrollWheelZoom)?e.scrollWheelZoom:l.doubleClickZoom,l.tap=n(e.tap)?e.tap:l.tap,l.touchZoom=n(e.touchZoom)?e.touchZoom:l.doubleClickZoom,l.zoomControl=n(e.zoomControl)?e.zoomControl:l.zoomControl,l.zoomsliderControl=n(e.zoomsliderControl)?e.zoomsliderControl:l.zoomsliderControl,l.attributionControl=n(e.attributionControl)?e.attributionControl:l.attributionControl,l.tileLayer=n(e.tileLayer)?e.tileLayer:l.tileLayer,l.zoomControlPosition=n(e.zoomControlPosition)?e.zoomControlPosition:l.zoomControlPosition,l.keyboard=n(e.keyboard)?e.keyboard:l.keyboard,l.dragging=n(e.dragging)?e.dragging:l.dragging,n(e.controls)&&angular.extend(l.controls,e.controls),r(e.crs)?l.crs=e.crs:n(L.CRS[e.crs])&&(l.crs=L.CRS[e.crs]),n(e.center)&&angular.copy(e.center,l.center),n(e.tileLayerOptions)&&angular.copy(e.tileLayerOptions,l.tileLayerOptions),n(e.maxZoom)&&(l.maxZoom=e.maxZoom),n(e.minZoom)&&(l.minZoom=e.minZoom),n(e.zoomAnimation)&&(l.zoomAnimation=e.zoomAnimation),n(e.fadeAnimation)&&(l.fadeAnimation=e.fadeAnimation),n(e.markerZoomAnimation)&&(l.markerZoomAnimation=e.markerZoomAnimation),n(e.worldCopyJump)&&(l.worldCopyJump=e.worldCopyJump),n(e.map)&&(l.map=e.map));var s=o(i,t);return i[s]=l,l}}}]),angular.module("leaflet-directive").factory("leafletEvents",["$rootScope","$q","$log","leafletHelpers",function(e,t,a,n){var r=n.safeApply,o=n.isDefined,i=n.isObject,l=n,s=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu"]},u=function(e,t,a,n){for(var r=s(),o="markers."+n,i=0;i<r.length;i++){var l=r[i];a.label.on(l,f(e,l,t,a.label,o))}},c=function(t,a,n,o,i,l){return function(s){var u="leafletDirectiveMarker."+t;"click"===t?r(n,function(){e.$broadcast("leafletDirectiveMarkersClick",i)}):"dragend"===t&&(r(n,function(){l.lat=o.getLatLng().lat,l.lng=o.getLatLng().lng}),l.message&&l.focus===!0&&o.openPopup()),r(n,function(t){"emit"===a?t.$emit(u,{markerName:i,leafletEvent:s}):e.$broadcast(u,{markerName:i,leafletEvent:s})})}},d=function(t,a,n,o,i){return function(o){var l="leafletDirectivePath."+t;r(n,function(t){"emit"===a?t.$emit(l,{pathName:i,leafletEvent:o}):e.$broadcast(l,{pathName:i,leafletEvent:o})})}},f=function(t,a,n,o,i){return function(l){var s="leafletDirectiveLabel."+a,u=i.replace("markers.","");r(t,function(t){"emit"===n?t.$emit(s,{leafletEvent:l,label:o,markerName:u}):"broadcast"===n&&e.$broadcast(s,{leafletEvent:l,label:o,markerName:u})})}},p=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose"]},g=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","add","remove","popupopen","popupclose"]};return{getAvailableMapEvents:function(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose","draw:created","draw:edited","draw:deleted","draw:drawstart","draw:drawstop","draw:editstart","draw:editstop","draw:deletestart","draw:deletestop"]},genDispatchMapEvent:function(t,a,n){return function(o){var i="leafletDirectiveMap."+a;r(t,function(t){"emit"===n?t.$emit(i,{leafletEvent:o}):"broadcast"===n&&e.$broadcast(i,{leafletEvent:o})})}},getAvailableMarkerEvents:p,getAvailablePathEvents:g,notifyCenterChangedToBounds:function(e){e.$broadcast("boundsChanged")},notifyCenterUrlHashChanged:function(e,t,a,n){if(o(a.urlHashCenter)){var r=t.getCenter(),i=r.lat.toFixed(4)+":"+r.lng.toFixed(4)+":"+t.getZoom();o(n.c)&&n.c===i||e.$emit("centerUrlHash",i)}},bindMarkerEvents:function(e,t,n,r){var s,d,f=[],g="emit";if(o(r.eventBroadcast))if(i(r.eventBroadcast))if(o(r.eventBroadcast.marker))if(i(r.eventBroadcast.marker)){void 0!==r.eventBroadcast.marker.logic&&null!==r.eventBroadcast.marker.logic&&("emit"!==r.eventBroadcast.marker.logic&&"broadcast"!==r.eventBroadcast.marker.logic?a.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===r.eventBroadcast.marker.logic&&(g="emit"));var v=!1,h=!1;if(void 0!==r.eventBroadcast.marker.enable&&null!==r.eventBroadcast.marker.enable&&"object"==typeof r.eventBroadcast.marker.enable&&(v=!0),void 0!==r.eventBroadcast.marker.disable&&null!==r.eventBroadcast.marker.disable&&"object"==typeof r.eventBroadcast.marker.disable&&(h=!0),v&&h)a.warn("[AngularJS - Leaflet] can not enable and disable events at the same time");else if(v||h)if(v)for(s=0;s<r.eventBroadcast.marker.enable.length;s++)d=r.eventBroadcast.marker.enable[s],-1!==f.indexOf(d)?a.warn("[AngularJS - Leaflet] This event "+d+" is already enabled"):-1===p().indexOf(d)?a.warn("[AngularJS - Leaflet] This event "+d+" does not exist"):f.push(d);else for(f=p(),s=0;s<r.eventBroadcast.marker.disable.length;s++){d=r.eventBroadcast.marker.disable[s];var m=f.indexOf(d);-1===m?a.warn("[AngularJS - Leaflet] This event "+d+" does not exist or has been already disabled"):f.splice(m,1)}else a.warn("[AngularJS - Leaflet] must enable or disable events")}else a.warn("[AngularJS - Leaflet] event-broadcast.marker must be an object check your model.");else f=p();else a.error("[AngularJS - Leaflet] event-broadcast must be an object check your model.");else f=p();for(s=0;s<f.length;s++)d=f[s],e.on(d,c(d,g,r,e,t,n));l.LabelPlugin.isLoaded()&&o(e.label)&&u(r,g,e,t)},bindPathEvents:function(e,t,n,r){var s,c,f=[],p="broadcast";if(o(r.eventBroadcast))if(i(r.eventBroadcast))if(o(r.eventBroadcast.path))if(i(r.eventBroadcast.paths))a.warn("[AngularJS - Leaflet] event-broadcast.path must be an object check your model.");else{void 0!==r.eventBroadcast.path.logic&&null!==r.eventBroadcast.path.logic&&("emit"!==r.eventBroadcast.path.logic&&"broadcast"!==r.eventBroadcast.path.logic?a.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===r.eventBroadcast.path.logic&&(p="emit"));var v=!1,h=!1;if(void 0!==r.eventBroadcast.path.enable&&null!==r.eventBroadcast.path.enable&&"object"==typeof r.eventBroadcast.path.enable&&(v=!0),void 0!==r.eventBroadcast.path.disable&&null!==r.eventBroadcast.path.disable&&"object"==typeof r.eventBroadcast.path.disable&&(h=!0),v&&h)a.warn("[AngularJS - Leaflet] can not enable and disable events at the same time");else if(v||h)if(v)for(s=0;s<r.eventBroadcast.path.enable.length;s++)c=r.eventBroadcast.path.enable[s],-1!==f.indexOf(c)?a.warn("[AngularJS - Leaflet] This event "+c+" is already enabled"):-1===g().indexOf(c)?a.warn("[AngularJS - Leaflet] This event "+c+" does not exist"):f.push(c);else for(f=g(),s=0;s<r.eventBroadcast.path.disable.length;s++){c=r.eventBroadcast.path.disable[s];var m=f.indexOf(c);-1===m?a.warn("[AngularJS - Leaflet] This event "+c+" does not exist or has been already disabled"):f.splice(m,1)}else a.warn("[AngularJS - Leaflet] must enable or disable events")}else f=g();else a.error("[AngularJS - Leaflet] event-broadcast must be an object check your model.");else f=g();for(s=0;s<f.length;s++)c=f[s],e.on(c,d(c,p,r,f,t));l.LabelPlugin.isLoaded()&&o(e.label)&&u(r,p,e,t)}}}]),angular.module("leaflet-directive").factory("leafletLayerHelpers",["$rootScope","$log","leafletHelpers",function($rootScope,$log,leafletHelpers){function isValidLayerType(e){return isString(e.type)?-1===Object.keys(layerTypes).indexOf(e.type)?($log.error("[AngularJS - Leaflet] A layer must have a valid type: "+Object.keys(layerTypes)),!1):layerTypes[e.type].mustHaveUrl&&!isString(e.url)?($log.error("[AngularJS - Leaflet] A base layer must have an url"),!1):layerTypes[e.type].mustHaveData&&!isDefined(e.data)?($log.error('[AngularJS - Leaflet] The base layer must have a "data" array attribute'),!1):layerTypes[e.type].mustHaveLayer&&!isDefined(e.layer)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have an layer defined"),!1):layerTypes[e.type].mustHaveBounds&&!isDefined(e.bounds)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have bounds defined"),!1):layerTypes[e.type].mustHaveKey&&!isDefined(e.key)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have key defined"),!1):!0:($log.error("[AngularJS - Leaflet] A layer must have a valid type defined."),!1)}function createLayer(e){if(isValidLayerType(e)){if(!isString(e.name))return void $log.error("[AngularJS - Leaflet] A base layer must have a name");isObject(e.layerParams)||(e.layerParams={}),isObject(e.layerOptions)||(e.layerOptions={});for(var t in e.layerParams)e.layerOptions[t]=e.layerParams[t];var a={url:e.url,data:e.data,options:e.layerOptions,layer:e.layer,type:e.layerType,bounds:e.bounds,key:e.key,pluginOptions:e.pluginOptions,user:e.user};return layerTypes[e.type].createLayer(a)}}var Helpers=leafletHelpers,isString=leafletHelpers.isString,isObject=leafletHelpers.isObject,isDefined=leafletHelpers.isDefined,utfGridCreateLayer=function(e){if(!Helpers.UTFGridPlugin.isLoaded())return void $log.error("[AngularJS - Leaflet] The UTFGrid plugin is not loaded.");var t=new L.UtfGrid(e.url,e.pluginOptions);return t.on("mouseover",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)}),t.on("mouseout",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)}),t.on("click",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)}),t},layerTypes={xyz:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer(e.url,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){var t="//{s}.tiles.mapbox.com/v3/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(t,e.options)}},geoJSON:{mustHaveUrl:!0,createLayer:function(e){return Helpers.GeoJSONPlugin.isLoaded()?new L.TileLayer.GeoJSON(e.url,e.pluginOptions,e.options):void 0}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},cartodbTiles:{mustHaveKey:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(t,e.options)}},cartodbUTFGrid:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){return e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json",utfGridCreateLayer(e)}},cartodbInteractive:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){var t="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png",a=L.tileLayer(t,e.options);e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json";var n=utfGridCreateLayer(e);return L.layerGroup([a,n])}},wms:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wms(e.url,e.options)}},wmts:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wmts(e.url,e.options)}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function(params){if(Helpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}}},group:{mustHaveUrl:!1,createLayer:function(e){var t=[];return angular.forEach(e.options.layers,function(e){t.push(createLayer(e))}),L.layerGroup(t)}},featureGroup:{mustHaveUrl:!1,createLayer:function(){return L.featureGroup()}},google:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"SATELLITE";return Helpers.GoogleLayerPlugin.isLoaded()?new L.Google(t,e.options):void 0}},china:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"";return Helpers.ChinaLayerPlugin.isLoaded()?L.tileLayer.chinaProvider(t,e.options):void 0}},ags:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSLayerPlugin.isLoaded()){var t=angular.copy(e.options);angular.extend(t,{url:e.url});var a=new lvector.AGS(t);return a.onAdd=function(e){this.setMap(e)},a.onRemove=function(){this.setMap(null)},a}}},dynamic:{mustHaveUrl:!0,createLayer:function(e){return Helpers.DynamicMapLayerPlugin.isLoaded()?L.esri.dynamicMapLayer(e.url,e.options):void 0}},markercluster:{mustHaveUrl:!1,createLayer:function(e){return Helpers.MarkerClusterPlugin.isLoaded()?new L.MarkerClusterGroup(e.options):void $log.error("[AngularJS - Leaflet] The markercluster plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){return Helpers.BingLayerPlugin.isLoaded()?new L.BingLayer(e.key,e.options):void 0}},heatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.HeatMapLayerPlugin.isLoaded()){var t=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&t.setData(e.data),t}}},yandex:{mustHaveUrl:!1,createLayer:function(e){var t=e.type||"map";return Helpers.YandexLayerPlugin.isLoaded()?new L.Yandex(t,e.options):void 0}},imageOverlay:{mustHaveUrl:!0,mustHaveBounds:!0,createLayer:function(e){return L.imageOverlay(e.url,e.bounds,e.options)}},custom:{createLayer:function(e){return e.layer instanceof L.Class?angular.copy(e.layer):void $log.error("[AngularJS - Leaflet] A custom layer must be a leaflet Class")}},cartodb:{mustHaveUrl:!0,createLayer:function(e){return cartodb.createLayer(e.map,e.url)}}};return{createLayer:createLayer}}]),angular.module("leaflet-directive").factory("leafletControlHelpers",["$rootScope","$log","leafletHelpers","leafletMapDefaults",function(e,t,a,n){var r,o=a.isObject,i=a.isDefined,l=function(e,t,a){var r=n.getDefaults(a);if(!r.controls.layers.visible)return!1;var i=0;return o(e)&&(i+=Object.keys(e).length),o(t)&&(i+=Object.keys(t).length),i>1},s=function(e){var t=n.getDefaults(e),a={collapsed:t.controls.layers.collapsed,position:t.controls.layers.position};angular.extend(a,t.controls.layers.options);var r;return r=t.controls.layers&&i(t.controls.layers.control)?t.controls.layers.control.apply(this,[[],[],a]):new L.control.layers([],[],a)};return{layersControlMustBeVisible:l,updateLayersControl:function(e,t,a,n,o,u){var c,d=l(n,o,t);if(i(r)&&a){for(c in u.baselayers)r.removeLayer(u.baselayers[c]);for(c in u.overlays)r.removeLayer(u.overlays[c]);r.removeFrom(e)}if(d){r=s(t);for(c in n){var f=i(n[c].layerOptions)&&n[c].layerOptions.showOnSelector===!1;!f&&i(u.baselayers[c])&&r.addBaseLayer(u.baselayers[c],n[c].name)}for(c in o){var p=i(o[c].layerOptions)&&o[c].layerOptions.showOnSelector===!1;!p&&i(u.overlays[c])&&r.addOverlay(u.overlays[c],o[c].name)}r.addTo(e)}return d}}}]),angular.module("leaflet-directive").factory("leafletLegendHelpers",function(){var e=function(e,t,a,n){if(e.innerHTML="",t.error)e.innerHTML+='<div class="info-title alert alert-danger">'+t.error.message+"</div>";else if("arcgis"===a)for(var r=0;r<t.layers.length;r++){var o=t.layers[r];e.innerHTML+='<div class="info-title" data-layerid="'+o.layerId+'">'+o.layerName+"</div>";for(var i=0;i<o.legend.length;i++){var l=o.legend[i];e.innerHTML+='<div class="inline" data-layerid="'+o.layerId+'"><img src="data:'+l.contentType+";base64,"+l.imageData+'" /></div><div class="info-label" data-layerid="'+o.layerId+'">'+l.label+"</div>"}}else"image"===a&&(e.innerHTML='<img src="'+n+'"/>')},t=function(t,a,n,r){return function(){var o=L.DomUtil.create("div",a);return L.Browser.touch?L.DomEvent.on(o,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(o),L.DomEvent.on(o,"mousewheel",L.DomEvent.stopPropagation)),e(o,t,n,r),o}},a=function(e,t){return function(){for(var a=L.DomUtil.create("div",t),n=0;n<e.colors.length;n++)a.innerHTML+='<div class="outline"><i style="background:'+e.colors[n]+'"></i></div><div class="info-label">'+e.labels[n]+"</div>";return L.Browser.touch?L.DomEvent.on(a,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(a),L.DomEvent.on(a,"mousewheel",L.DomEvent.stopPropagation)),a}};return{getOnAddLegend:t,getOnAddArrayLegend:a,updateLegend:e}}),angular.module("leaflet-directive").factory("leafletPathsHelpers",["$rootScope","$log","leafletHelpers",function(e,t,a){function n(e){return e.filter(function(e){return c(e)}).map(function(e){return r(e)})}function r(e){return s(e)?new L.LatLng(e[0],e[1]):new L.LatLng(e.lat,e.lng)}function o(e){return e.map(function(e){return n(e)})}function i(e,t){for(var a={},n=0;n<d.length;n++){var r=d[n];l(e[r])?a[r]=e[r]:l(t.path[r])&&(a[r]=t.path[r])}return a}var l=a.isDefined,s=a.isArray,u=a.isNumber,c=a.isValidPoint,d=["stroke","weight","color","opacity","fill","fillColor","fillOpacity","dashArray","lineCap","lineJoin","clickable","pointerEvents","className","smoothFactor","noClip"],f=function(e,t){for(var a={},n=0;n<d.length;n++){var r=d[n];l(t[r])&&(a[r]=t[r])}e.setStyle(t)},p=function(e){if(!s(e))return!1;for(var t=0;t<e.length;t++){var a=e[t];if(!c(a))return!1}return!0},g={polyline:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polyline([],e)},setPath:function(e,t){e.setLatLngs(n(t.latlngs)),f(e,t)}},multiPolyline:{isValid:function(e){var t=e.latlngs;if(!s(t))return!1;for(var a in t){var n=t[a];if(!p(n))return!1}return!0},createPath:function(e){return new L.multiPolyline([[[0,0],[1,1]]],e)},setPath:function(e,t){e.setLatLngs(o(t.latlngs)),f(e,t)}},polygon:{isValid:function(e){var t=e.latlngs;return p(t)},createPath:function(e){return new L.Polygon([],e)},setPath:function(e,t){e.setLatLngs(n(t.latlngs)),f(e,t)}},multiPolygon:{isValid:function(e){var t=e.latlngs;if(!s(t))return!1;for(var a in t){var n=t[a];if(!p(n))return!1}return!0},createPath:function(e){return new L.MultiPolygon([[[0,0],[1,1],[0,1]]],e)},setPath:function(e,t){e.setLatLngs(o(t.latlngs)),f(e,t)}},rectangle:{isValid:function(e){var t=e.latlngs;if(!s(t)||2!==t.length)return!1;for(var a in t){var n=t[a];if(!c(n))return!1}return!0},createPath:function(e){return new L.Rectangle([[0,0],[1,1]],e)},setPath:function(e,t){e.setBounds(new L.LatLngBounds(n(t.latlngs))),f(e,t)}},circle:{isValid:function(e){var t=e.latlngs;return c(t)&&u(e.radius)},createPath:function(e){return new L.Circle([0,0],1,e)},setPath:function(e,t){e.setLatLng(r(t.latlngs)),l(t.radius)&&e.setRadius(t.radius),f(e,t)}},circleMarker:{isValid:function(e){var t=e.latlngs;return c(t)&&u(e.radius)},createPath:function(e){return new L.CircleMarker([0,0],e)},setPath:function(e,t){e.setLatLng(r(t.latlngs)),l(t.radius)&&e.setRadius(t.radius),f(e,t)}}},v=function(e){var t={};return e.latlngs&&(t.latlngs=e.latlngs),e.radius&&(t.radius=e.radius),t};return{setPathOptions:function(e,t,a){l(t)||(t="polyline"),g[t].setPath(e,a)},createPath:function(e,a,n){l(a.type)||(a.type="polyline");var r=i(a,n),o=v(a);return g[a.type].isValid(o)?g[a.type].createPath(r):void t.error("[AngularJS - Leaflet] Invalid data passed to the "+a.type+" path")}}}]),angular.module("leaflet-directive").factory("leafletBoundsHelpers",["$log","leafletHelpers",function(e,t){function a(e){return angular.isDefined(e)&&angular.isDefined(e.southWest)&&angular.isDefined(e.northEast)&&angular.isNumber(e.southWest.lat)&&angular.isNumber(e.southWest.lng)&&angular.isNumber(e.northEast.lat)&&angular.isNumber(e.northEast.lng)}var n=t.isArray,r=t.isNumber;return{createLeafletBounds:function(e){return a(e)?L.latLngBounds([e.southWest.lat,e.southWest.lng],[e.northEast.lat,e.northEast.lng]):void 0},isValidBounds:a,createBoundsFromArray:function(t){return n(t)&&2===t.length&&n(t[0])&&n(t[1])&&2===t[0].length&&2===t[1].length&&r(t[0][0])&&r(t[0][1])&&r(t[1][0])&&r(t[1][1])?{northEast:{lat:t[0][0],lng:t[0][1]},southWest:{lat:t[1][0],lng:t[1][1]}}:void e.error("[AngularJS - Leaflet] The bounds array is not valid.")}}}]),angular.module("leaflet-directive").factory("leafletMarkersHelpers",["$rootScope","leafletHelpers","$log","$compile",function(e,t,a,n){var r=t.isDefined,o=t.MarkerClusterPlugin,i=t.AwesomeMarkersPlugin,l=t.MakiMarkersPlugin,s=t.ExtraMarkersPlugin,u=t.safeApply,c=t,d=t.isString,f=t.isNumber,p=t.isObject,g={},v=function(e){if(r(e)&&r(e.type)&&"awesomeMarker"===e.type)return i.isLoaded()||a.error("[AngularJS - Leaflet] The AwesomeMarkers Plugin is not loaded."),new L.AwesomeMarkers.icon(e);if(r(e)&&r(e.type)&&"makiMarker"===e.type)return l.isLoaded()||a.error("[AngularJS - Leaflet] The MakiMarkers Plugin is not loaded."),new L.MakiMarkers.icon(e);if(r(e)&&r(e.type)&&"extraMarker"===e.type)return s.isLoaded()||a.error("[AngularJS - Leaflet] The ExtraMarkers Plugin is not loaded."),new L.ExtraMarkers.icon(e);if(r(e)&&r(e.type)&&"div"===e.type)return new L.divIcon(e);var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=";return r(e)&&r(e.iconUrl)?new L.Icon(e):new L.Icon.Default({iconUrl:t,shadowUrl:n,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},h=function(e){r(g[e])&&g.splice(e,1)},m=function(){g={}},y=function(e,t,a){if(e.closePopup(),r(a)&&r(a.overlays))for(var n in a.overlays)if((a.overlays[n]instanceof L.LayerGroup||a.overlays[n]instanceof L.FeatureGroup)&&a.overlays[n].hasLayer(e))return void a.overlays[n].removeLayer(e);if(r(g))for(var o in g)g[o].hasLayer(e)&&g[o].removeLayer(e);t.hasLayer(e)&&t.removeLayer(e)},b=function(t,a){t.openPopup();var o=t.getPopup(),i=angular.isFunction(a.getMessageScope)?a.getMessageScope():e,l=r(a.compileMessage)?a.compileMessage:!0;if(r(o)){var s=function(e){e._updateLayout(),e._updatePosition()};if(l)if(n(o._contentNode)(i),r(o._contentNode)&&o._contentNode.innerHTML.indexOf("ngInclude")>-1)var u=i.$on("$includeContentLoaded",function(){s(o),u()});else s(o)}c.LabelPlugin.isLoaded()&&r(a.label)&&r(a.label.options)&&a.label.options.noHide===!0&&(l&&n(t.label._container)(i),t.showLabel())};return{resetMarkerGroup:h,resetMarkerGroups:m,deleteMarker:y,manageOpenPopup:b,createMarker:function(e){if(!r(e))return void a.error("[AngularJS - Leaflet] The marker definition is not valid.");var t={icon:v(e.icon),title:r(e.title)?e.title:"",draggable:r(e.draggable)?e.draggable:!1,clickable:r(e.clickable)?e.clickable:!0,riseOnHover:r(e.riseOnHover)?e.riseOnHover:!1,zIndexOffset:r(e.zIndexOffset)?e.zIndexOffset:0,iconAngle:r(e.iconAngle)?e.iconAngle:0};for(var n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n]);var o=new L.marker(e,t);return d(e.message)||o.unbindPopup(),o},addMarkerToGroup:function(e,t,n,i){return d(t)?o.isLoaded()?(r(g[t])||(g[t]=new L.MarkerClusterGroup(n),i.addLayer(g[t])),void g[t].addLayer(e)):void a.error("[AngularJS - Leaflet] The MarkerCluster plugin is not loaded."):void a.error("[AngularJS - Leaflet] The marker group you have specified is invalid.")},listenMarkerEvents:function(e,t,a,n){e.on("popupopen",function(){n?u(a,function(){t.focus=!0}):b(e,t)}),e.on("popupclose",function(){n&&u(a,function(){t.focus=!1})})},addMarkerWatcher:function(e,t,n,o,i){var l=n.$watch('markers["'+t+'"]',function(t,n){if(!r(t))return y(e,i,o),void l();if(r(n)){if(!f(t.lat)||!f(t.lng))return a.warn("There are problems with lat-lng data, please verify your marker model"),void y(e,i,o);var s=t===n;if(r(t.iconAngle)&&n.iconAngle!==t.iconAngle&&e.setIconAngle(t.iconAngle),d(t.layer)||d(n.layer)&&(r(o.overlays[n.layer])&&o.overlays[n.layer].hasLayer(e)&&(o.overlays[n.layer].removeLayer(e),e.closePopup()),i.hasLayer(e)||i.addLayer(e)),(f(t.opacity)||f(parseFloat(t.opacity)))&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),d(t.layer)&&n.layer!==t.layer){if(d(n.layer)&&r(o.overlays[n.layer])&&o.overlays[n.layer].hasLayer(e)&&o.overlays[n.layer].removeLayer(e),e.closePopup(),i.hasLayer(e)&&i.removeLayer(e),!r(o.overlays[t.layer]))return void a.error("[AngularJS - Leaflet] You must use a name of an existing layer");var u=o.overlays[t.layer];if(!(u instanceof L.LayerGroup||u instanceof L.FeatureGroup))return void a.error('[AngularJS - Leaflet] A marker can only be added to a layer of type "group" or "featureGroup"');u.addLayer(e),i.hasLayer(e)&&t.focus===!0&&b(e,t)}if(t.draggable!==!0&&n.draggable===!0&&r(e.dragging)&&e.dragging.disable(),t.draggable===!0&&n.draggable!==!0&&(e.dragging?e.dragging.enable():L.Handler.MarkerDrag&&(e.dragging=new L.Handler.MarkerDrag(e),e.options.draggable=!0,e.dragging.enable())),p(t.icon)||p(n.icon)&&(e.setIcon(v()),e.closePopup(),e.unbindPopup(),d(t.message)&&e.bindPopup(t.message,t.popupOptions)),p(t.icon)&&p(n.icon)&&!angular.equals(t.icon,n.icon)){var g=!1;e.dragging&&(g=e.dragging.enabled()),e.setIcon(v(t.icon)),g&&e.dragging.enable(),e.closePopup(),e.unbindPopup(),d(t.message)&&e.bindPopup(t.message,t.popupOptions)}!d(t.message)&&d(n.message)&&(e.closePopup(),e.unbindPopup()),c.LabelPlugin.isLoaded()&&r(t.label)&&r(t.label.message)&&!angular.equals(t.label.message,n.label.message)&&e.updateLabelContent(t.label.message),d(t.message)&&!d(n.message)&&e.bindPopup(t.message,t.popupOptions),d(t.message)&&d(n.message)&&t.message!==n.message&&e.setPopupContent(t.message);var h=!1;t.focus!==!0&&n.focus===!0&&(e.closePopup(),h=!0),(t.focus===!0&&(!r(n.focus)||n.focus===!1)||s&&t.focus===!0)&&(b(e,t),h=!0),n.zIndexOffset!==t.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset);var m=e.getLatLng(),k=d(t.layer)&&c.MarkerClusterPlugin.is(o.overlays[t.layer]);k?h?(t.lat!==n.lat||t.lng!==n.lng)&&(o.overlays[t.layer].removeLayer(e),e.setLatLng([t.lat,t.lng]),o.overlays[t.layer].addLayer(e)):m.lat!==t.lat||m.lng!==t.lng?(o.overlays[t.layer].removeLayer(e),e.setLatLng([t.lat,t.lng]),o.overlays[t.layer].addLayer(e)):t.lat!==n.lat||t.lng!==n.lng?(o.overlays[t.layer].removeLayer(e),e.setLatLng([t.lat,t.lng]),o.overlays[t.layer].addLayer(e)):p(t.icon)&&p(n.icon)&&!angular.equals(t.icon,n.icon)&&(o.overlays[t.layer].removeLayer(e),o.overlays[t.layer].addLayer(e)):(m.lat!==t.lat||m.lng!==t.lng)&&e.setLatLng([t.lat,t.lng])}},!0)}}}]),angular.module("leaflet-directive").factory("leafletHelpers",["$q","$log",function(e,t){function a(e,a){var n,r;if(angular.isDefined(a))n=a;else if(0===Object.keys(e).length)n="main";else if(Object.keys(e).length>=1)for(r in e)e.hasOwnProperty(r)&&(n=r);else 0===Object.keys(e).length?n="main":t.error("[AngularJS - Leaflet] - You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call");return n}function n(t,n){var r,o=a(t,n);return angular.isDefined(t[o])&&t[o].resolvedDefer!==!0?r=t[o].defer:(r=e.defer(),t[o]={defer:r,resolvedDefer:!1}),r}return{isEmpty:function(e){return 0===Object.keys(e).length},isUndefinedOrEmpty:function(e){return angular.isUndefined(e)||null===e||0===Object.keys(e).length},isDefined:function(e){return angular.isDefined(e)&&null!==e},isNumber:function(e){return angular.isNumber(e)},isString:function(e){return angular.isString(e)},isArray:function(e){return angular.isArray(e)},isObject:function(e){return angular.isObject(e)},isFunction:function(e){return angular.isFunction(e)},equals:function(e,t){return angular.equals(e,t)},isValidCenter:function(e){return angular.isDefined(e)&&angular.isNumber(e.lat)&&angular.isNumber(e.lng)&&angular.isNumber(e.zoom)},isValidPoint:function(e){return angular.isDefined(e)?angular.isArray(e)?2===e.length&&angular.isNumber(e[0])&&angular.isNumber(e[1]):angular.isNumber(e.lat)&&angular.isNumber(e.lng):!1},isSameCenterOnMap:function(e,t){var a=t.getCenter(),n=t.getZoom();return e.lat&&e.lng&&a.lat.toFixed(4)===e.lat.toFixed(4)&&a.lng.toFixed(4)===e.lng.toFixed(4)&&n===e.zoom?!0:!1},safeApply:function(e,t){var a=e.$root.$$phase;"$apply"===a||"$digest"===a?e.$eval(t):e.$apply(t)
},obtainEffectiveMapId:a,getDefer:function(e,t){var r,o=a(e,t);return r=angular.isDefined(e[o])&&e[o].resolvedDefer!==!1?e[o].defer:n(e,t)},getUnresolvedDefer:n,setResolvedDefer:function(e,t){var n=a(e,t);e[n].resolvedDefer=!0},AwesomeMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.AwesomeMarkers)&&angular.isDefined(L.AwesomeMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.AwesomeMarkers.Icon:!1},equal:function(e,t){return this.isLoaded()&&this.is(e)?angular.equals(e,t):!1}},PolylineDecoratorPlugin:{isLoaded:function(){return angular.isDefined(L.PolylineDecorator)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.PolylineDecorator:!1},equal:function(e,t){return this.isLoaded()&&this.is(e)?angular.equals(e,t):!1}},MakiMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.MakiMarkers)&&angular.isDefined(L.MakiMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.MakiMarkers.Icon:!1},equal:function(e,t){return this.isLoaded()&&this.is(e)?angular.equals(e,t):!1}},ExtraMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.ExtraMarkers)&&angular.isDefined(L.ExtraMarkers.Icon)?!0:!1},is:function(e){return this.isLoaded()?e instanceof L.ExtraMarkers.Icon:!1},equal:function(e,t){return this.isLoaded()&&this.is(e)?angular.equals(e,t):!1}},LabelPlugin:{isLoaded:function(){return angular.isDefined(L.Label)},is:function(e){return this.isLoaded()?e instanceof L.MarkerClusterGroup:!1}},MarkerClusterPlugin:{isLoaded:function(){return angular.isDefined(L.MarkerClusterGroup)},is:function(e){return this.isLoaded()?e instanceof L.MarkerClusterGroup:!1}},GoogleLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Google)},is:function(e){return this.isLoaded()?e instanceof L.Google:!1}},ChinaLayerPlugin:{isLoaded:function(){return angular.isDefined(L.tileLayer.chinaProvider)}},HeatMapLayerPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.WebGLHeatMap)}},BingLayerPlugin:{isLoaded:function(){return angular.isDefined(L.BingLayer)},is:function(e){return this.isLoaded()?e instanceof L.BingLayer:!1}},WFSLayerPlugin:{isLoaded:function(){return void 0!==L.GeoJSON.WFS},is:function(e){return this.isLoaded()?e instanceof L.GeoJSON.WFS:!1}},AGSLayerPlugin:{isLoaded:function(){return void 0!==lvector&&void 0!==lvector.AGS},is:function(e){return this.isLoaded()?e instanceof lvector.AGS:!1}},YandexLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Yandex)},is:function(e){return this.isLoaded()?e instanceof L.Yandex:!1}},DynamicMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.dynamicMapLayer},is:function(e){return this.isLoaded()?e instanceof L.esri.dynamicMapLayer:!1}},GeoJSONPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.GeoJSON)},is:function(e){return this.isLoaded()?e instanceof L.TileLayer.GeoJSON:!1}},UTFGridPlugin:{isLoaded:function(){return angular.isDefined(L.UtfGrid)},is:function(e){return this.isLoaded()?e instanceof L.UtfGrid:(t.error("[AngularJS - Leaflet] No UtfGrid plugin found."),!1)}},CartoDB:{isLoaded:function(){return cartodb},is:function(){return!0}},Leaflet:{DivIcon:{is:function(e){return e instanceof L.DivIcon},equal:function(e,t){return this.is(e)?angular.equals(e,t):!1}},Icon:{is:function(e){return e instanceof L.Icon},equal:function(e,t){return this.is(e)?angular.equals(e,t):!1}}}}}])}(),app.directive("header",function(){return{restrict:"E",replace:!0,templateUrl:"header.html",controller:["$scope",function(){}]}}),app.controller("MainNavCtrl",["$scope","$location","$modal",function(e,t){e.navCollapsed=!0,e.isActive=function(e){return e==t.path()}}]),app.controller("SiteCtrl",["$scope","$http",function(e,t){angular.extend(e,{defaults:{tileLayer:"http://{s}.tiles.mapbox.com/v3/jungledre.j2b12cd5/{z}/{x}/{y}.png",scrollWheelZoom:!1,maxZoom:15,path:{weight:10,color:"#800000",opacity:1}},events:{}}),e.center={lat:47.62337120374077,lng:-122.33027305730623,zoom:13},e.placeMarker=function(){e.center={lat:e.selected.location.lat,lng:e.selected.location.lng,zoom:13},e.markers.push({lat:e.selected.location.lat,lng:e.selected.location.lng,focus:!0,title:"Marker",icon:{iconUrl:e.selected.categories[0].icon.prefix+"bg_32"+e.selected.categories[0].icon.suffix,iconSize:[32,32],shadowSize:[50,64],iconAnchor:[16,32],shadowAnchor:[4,62],popupAnchor:[-3,-76]},label:{message:e.selected.name,options:{noHide:!0}}}),e.selected=""},e.getLocation=function(a){return t.get("/foursquare",{params:{location:"seattle,wa",query:a}}).then(function(t){return t.data.map(function(t){return e.location=t,e.location})})},e.getMarkers=function(){return t.get("/marker").success(function(t){for(var a=t.length-1;a>=0;a--)t[a].lat=parseFloat(t[a].lat),t[a].lng=parseFloat(t[a].lng);return e.markers=t,e.markers})},e.saveMap=function(){var a=e.markers.map(function(e){return{venue:e.label.message,lat:e.lat,lng:e.lng,icon:e.icon.iconUrl}});e.alert=!1,t.post("/marker",{point:a}).success(function(){console.log("Posted yer shit")}).error(function(e){console.log(e)})},e.getMarkers()}]),angular.module("templates").run(["$templateCache",function(e){e.put("about.html",'<header></header>\n<h2>Visit <a href="/adriennekerr.com">AdrienneKerr.com</a> to learn more about this site.</h2>')}]),angular.module("templates").run(["$templateCache",function(e){e.put("header.html",'<nav ng-controller="MainNavCtrl" class="navbar navbar-default #desktopHeader">\n  <div class="container-fluid">\n    <!-- Brand and toggle get grouped for better mobile display -->\n    <div class="navbar-header">\n      <a class="navbar-brand" href="/">Bloggy {{1+0}}.0</a>\n    </div>\n\n    <!-- Collect the nav links, forms, and other content for toggling -->\n    <div collapse="navCollapsed" class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n      <ul class="nav navbar-nav">\n        <li ng-class="{active:isActive(\'/about\')}"><a href="/about">About</a></li>\n        <li ng-class="{active:isActive(\'/map\')}"><a href="/map">Browse</a></li>\n      </ul>\n      <ul class="nav navbar-nav navbar-right">\n        <li><a ng-hide="currentUser" ng-click="showLogin()">Login</a></li>\n        <li><a href="" ng-show="currentUser" ng-click="logout()">Logout</a></li>\n        <li><a ng-hide="currentUser" ng-click="showSignup()">Signup</a></li>\n\n      <form ng-submit="search()" class="navbar-form navbar-left" role="search">\n        <div class="form-group">\n          <input ng-model="searchTerm" type="text" class="form-control" placeholder="Search Posts">\n        </div>\n        <button type="submit" class="btn btn-default">Submit</button>\n      </form>\n      </ul>\n    </div><!-- /.navbar-collapse -->\n  </div><!-- /.container-fluid -->\n</nav>')}]),angular.module("templates").run(["$templateCache",function(e){e.put("index.html",'<div class="container-fluid">\n\n  <div id="splash" class="col-xs-offset-3 col-md-offset-4 col-xs-6 col-md-4">\n    <h1>Field Guide</h1>\n    <p>\n      <a href="/new" class="btn btn-primary" role="button">Create</a>\n      <a href="/map" class="btn btn-default" role="button">Browse</a>\n    </p>\n  </div>\n\n  <leaflet id="splash-map" defaults="defaults" center="center" event-broadcast="events" height="100vh" width="100%">\n  </leaflet>\n\n</div>')}]),angular.module("templates").run(["$templateCache",function(e){e.put("map.html",'<header></header>\n\n<div class="container">\n  <div class="col-xs-6">\n    <h2>Existing Map</h2>\n  </div>\n\n  <div class="container-fluid leaflet-map">\n    <leaflet defaults="defaults" center="center" markers="markers" event-broadcast="events" height="100vh" width="100%"></leaflet>\n  </div>\n</div>\n')}]),angular.module("templates").run(["$templateCache",function(e){e.put("new.html",'<h2>Foursquare Results</h2>\n\n<form class="form" ng-submit="placeMarker()">\n  <div class="form-group">\n    <input type="text" ng-model="selected" placeholder="Please enter a location"\n         typeahead="address as address[\'name\'] + \' \u2014 \' + address[\'location\'][\'formattedAddress\'] for address in getLocation($viewValue)"\n         typeahead-loading="loadingLocations" typeahead-min-length="3" class="form-control">\n  </div>\n  <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>\n  <input ng-hide="loadingLocations" type="submit" class="btn btn-default" name="Search"></input>\n</form>\n\n<input type="submit" ng-click="saveMap()" class="btn btn-default" value="Save Map"></input>\n<input type="submit" ng-click="getMarkers()" class="btn btn-default" value="Show Markers"></input>\n\n<br><br>\n\n</div>\n\n<div class="container-fluid leaflet-map">\n  <leaflet defaults="defaults" center="center" markers="markers" event-broadcast="events" height="70vh" width="100%"></leaflet>\n</div>')}]),function(){}.call(this),function(){}.call(this),function(){}.call(this),function(){}.call(this);